
<article>
<header>
<a id="copy-protection"></a>
<h2>Curiosità: Savegame & Copy Protection Interface</h2>
<time datetime="2015-07-01T09:00:00+01:00">1 Luglio 2015</time>
</header>
<p>All'epoca, io e mio fratello eravamo alle prese con <b>Indiana Jones and the Fate of Atlantis</b>, stavamo giocando con il percorso che, inconsapevolmente, credevamo essere l'unico possibile: il <b>Percorso Squadra</b>.
<p>In seguito un nostro amichetto ci aprì gli occhi sulla verità: avevamo appena scoperto l'esistenza di ben altri 2 modi diversi di giocare la stessa avventura, uno in cui farsi largo con la forza bruta sfidando i cattivi a suon di pugni, l'altro più macchinoso in cui gli enigmi erano ancora più difficili. Si trattava rispettivamente del percorso <b>Pugni</b> e del percorso <b>Ingegno</b>.</p>

<p>La cosa che ci saltò all'occhio immediatamente era che il nostro amichetto, in quel momento stava esplorando luoghi di cui mio fratello ed io non sapevamo nemmeno l'esistenza: "Come ci sei riuscito?"</p>
<p>D'altronde saremmo stati benissimo in grado di scoprirlo anche noi, con le nostre sole forze: c'erano le riviste specializzate, ma noi non le compravamo e di sicuro non le leggevamo.</p>
<p>A dire il vero avevamo a disposizione anche una vecchia copia interamente fotocopiata del manuale di gioco che era però in inglese e figuriamoci...</p>
<p>Forse un indizio dal quale avremmo potuto capire era quella immagine proprio tra le prime pagine del manuale...</p>

<div class="img">
<img alt="boat image" src="http://www.limulo.net/images/scumm/boat-image.jpg" />
</div>

<p>Una barca? ma quando? dove?</p>
<p>Cosa curiosa è che, se avessimo letto quel manuale però, oltre a scoprire l'esistenza di più percorsi di gioco, avremmo certo risparmiato una nottata insonne a nostro padre!</p>
<p>Ricordo distintamente un episodio in cui lui ci chiamò, era tardi ed era ormai ora di andare a letto. Io e mio fratello avevamo impiegato l'intera giornata, come oramai facevamo da settimane durante quell'estate, per progredire più che potevamo con l'avvetura di Indy.</p>

<p>Eravamo affranti dal fatto che, se non ce l'avessimo fatta, saremmo poi stati costretti a ricominciare tutto da capo l'indomani, ben sapendo che spegnere il PC per andare a letto, significava perdere tutti i progressi fatti fino a quel momento. Nella nostrà ingenuità ignoravamo assolutamente l'esistenza dei <b>Salvataggi</b>.</p>

<p>Fu nostro padre che nel vederci così disperati, mosso a compassione, spento il computer e messici a letto, decise di prendere quel manuale e cominciare a sfogliarlo.</p>
<p>Io non so che sforzo indicibile possa essere stato per lui, decisamente avverso alla tecnologia, allora come oggi, affrontare quel manuale, in inglese, durante la notte e leggere di requisiti di sistema, di installazioni, percorsi, controlli e altre stramberie senza senso...</p>
<p>Fatto sta che lo fece: l'indomani a pranzo ci svelò una più grande verità: l'esistenza di un modo per <em>salvare</em> i propri progressi aprendoci un mondo di nuove possibilità, fu allora che mio fratello ed io scoprimmo i <b>Salvataggi</b>!!!</p>

<div >
<img style="width: 100%;" alt="combinazioni" src="http://www.limulo.net/images/scumm/combinazioni.png" />
</div>

<p>Rimembranze a parte, qualche tempo fa mi sono tornati alla mente altri particolari. Forse non sono l'unico ad essermi chiesto "ma che fine hanno fatto gli enigmi iniziali? Quelli che eri obbligato a superare ancor prima di cominciare a giocare sul serio?"</p>

<p>Forse alcuni di voi si ricorderanno di immagini come queste:</p>
<table class="img" style="width: 100%;">  
<tr>
  <td>
    <img src="http://www.limulo.net/images/scumm/copy-protection-indy-2.png" alt="Indy Copy Protection"/>
  </td>
  <td>
    <img src="http://www.limulo.net/images/scumm/copy-protection-monkey2-2.png" alt="Monkey 2 Copy Protection" />
  </td>
<tr>
  <td>
    <img src="http://www.limulo.net/images/scumm/copy-protection-monkey.png" alt="Monkey Copy Protection" />
  </td>
  <td>
    <img src="http://www.limulo.net/images/scumm/copy-protection-samnmax.png" alt="Sam and Max Copy Protection" />
  </td>
</tr>
</table>


<p>E' interessante ricordare come questi sistemi fossero i primissimi tentativi ci controllo della copia.</p>
<p>All'epoca, per le case produttrici di software, non vi era praticamente nessun metodo che potesse impedire la copia: se qualcuno voleva passare il videogioco ad un amico, gli copiava i <em>floppini</em>; nulla di più semplice.</p>
<p>Tuttavia si poteva cercare di limitare questa tendenza applicando due principali strategie:</p>
<ul>
    <li>rendere il gioco qualcosa di unico e di desiderabile! Ecco allora le scatole decorate, che al loro interno contenevano i cosiddetti <em>feelies</em> <b>[a]</b> magari: accessori fisici come ad esempio mappe, cartoline, stampe, piccoli pupazzetti e soprammobili, etc...;</li>
    <li>legare il software a qualche altro oggetto che da un lato contenesse un indizio fondamentale per il completamento del gioco e dall'altro, la cui copia non sarebbe stata altrettanto agevole da parte dell'utente finale.</li>
</ul>

<p>Alcuni dei sistemi più usati nei videogiochi degli anni '80 e '90 era quello di inserire indizi chiave all'interno del manuale di gioco, magari in codice oppure nascosti tra le righe stampate in colori diversi, leggibili soltanto con speciali lenti colorate, oppure usare le simpatiche <em>Code wheel</em>: <em>Dial-A-Pirate</em> <b>[b]</b> per Monkey Island 1, solo per citarne una tra le più famose...</p>    

<p>Con l'andare del tempo questo sistema venne poco a poco abbandonato a causa degli alti costi di produzione e del progressivo diffondersi delle informazioni attraverso i sempre più comuni <em>forums</em>.</p>

<h3>Copy Protection via ScummVM</h3>
<p>Quando rigiochiamo ad uno di questi vecchi giochi su ScummVM, il software ignora questa sezione di <em>copy protection</em> se presente. E' comunque possibile attivarla utilizzando un parametro passato da console!</p>
<p>Infatti, se usiamo ScummVM avviandolo da console, è possibile impartire determinati comandi per eseguire operazioni di diverso tipo. Una di queste è proprio quella di attivare la sezione <em>copy-protection</em> per un particolare gioco.</p>
<p>Il comando da impartire è quello mostrato qui di seguito:</p>
<pre class="code">./scummvm --copy-protection TARGET</pre>

<p>dove per <span class="code">TARGET</span> si intende l'identificativo che ScummVM associa al gioco.</p>

<div class="dashed-border" style="padding: .5em;">
<p>Per conoscere tutti i nomi <span class="code">TARGET</span> dei giochi che avete aggiunto a ScummVM, usate il seguente comando da console:</p>
<pre class="code">./scummvm -t</pre>
</div>

<p>Come esempio quindi, ecco che se volessi riattivare la copy protection per Indiana Jones and The Fate of Atlantis via ScummVM (che ha come nome <span class="code">TARGET</span>: <em>atlantis-it</em>), devo usare il seguente comando da console:</p>
<pre class="code">./scummvm --copy-protection atlantis-it</pre>
<p>Ho notato che il comando non funziona per tutti i giochi.<br>Questo è probabilmente imputabile al fatto che il codice necessario per il funzionamento della <em>copy-protection</em> non venne originariamente implementato in alcune versioni.</p>
<p>Un esempio è Monkey Island versione CD: forse per l'epoca l'impossibilità di masterizzare il supporto già costituiva in sè un deterrente piuttosto efficace, senza doversi accanire ulteriormente con la <em>copy-protection</em> software!</p>
<p><br></p>
<div class="nota">
<p>Per maggiori informazioni sull'uso di ScummVM via terminale usate quest'altro comando per accedere alla sezione HELP:</p>
<pre class="code">./scummvm -h</pre>
<p>In alternativa potete consultare la pagina Wiki del progetto ScummVM dedicata <b>[c]</b>.</p>
</div>

<div class="author">Nicola</div>

<h3>Riferimenti</h3>

<p><b>Links</b></p>
<ul>
    <li><b>[a]</b> da Wikipedia: <a class="ext" href="https://en.wikipedia.org/wiki/Feelie" target="_blank">feelie</a>;</li>
    <li><b>[b]</b> Online interactive version of The Secret of Monkey Island "<a class="ext" href="http://www.oldgames.sk/docs/Dial-A-Pirate/" target="_blank">Dial-A-Pirate</a>" wheel;</li>
    <li><b>[c]</b> ScummVM <a class="ext" href="http://wiki.scummvm.org/index.php/User_Manual/Appendix:_Command_line_options" target="_blank">Wiki</a>;</li>
    <li>Un <a class="ext" href="http://gameological.com/2013/05/inventory-9-games-with-creative-drm-copy-protection/" target="_blank">articolo</a> carino sui vecchi sistemi di copy protection.</li>
</ul>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>



<!-- -->
<article>
<header>
<a id="glossario"></a>
<h2>Glossario</h2>
<time datetime="2015-08-01T09:00:00+01:00">1 Agosto 2015</time>
</header>

 <p>Negli articoli precedenti abbiamo accennato velocemente alle <em>risorse</em> del gioco: abbiamo visto nello specifico come un gioco di avventura della LucasArts sia suddiviso in 2 principali componenti: uno è l'<b>interprete</b>, l'altro è l'insieme delle <b>risorse</b> di gioco come suoni, immagini, testi, scripts, etc.</p>

<p>L'intertprete è un programma specifico per la piattaforma su cui si desidera giocare. Ci sarà quindi un interprete Commodore 64, uno per Pc, un'altro ancora per Mac, etc.</p>
<p>Le risorse sono files comuni a tutte le versioni del gioco e sono lette dall'interprete che le elabora in maniera ottimale per il sistema in uso.</p>

<p>Prima di addentrarci a fondo nelle risorse volevo compilare di seguito un veloce elenco dei termini che ci capiterà più spesso di utilizzare, ai quali forse ho inevitabilmente dovuto fare riferimento anche in precedenza. Il loro significato potrebbe talvolta confondere e credo sia meglio mettere in chiaro alcune cose.</p>

<p>Col tempo mi riservo di ritornare qui per ampliare la sezione con nuovi termini specifici che, per ora, non è necessario approfondire: buona lettura!</p>

<h3>Actor</h3>
<p>L'<b>Attore</b> è una struttura di controllo astratta. E' attraverso gli <em>Attori</em> che l'engine riesce a controllare tutti quegli elementi di gioco che hanno bisogno di muoversi, parlare, agire nei modi più svariati all'interno del gioco.</p>

<p>Nei giochi LucasArts (e non solo) si usa il termine <em>Attore</em> per l'intrinseca relazione che esiste tra il tipo di videogioco e il cinema o il teatro, come abbiamo già detto: così come nel teatro esiste il palcoscenico e nel cinema ci sono diverse scenografie, anche il gioco possiede i propri equivalenti. Il palcoscenico per il videogioco d'avventura porta il nome di <b>room</b> e presto lo studieremo da vicino.</p>
<p>Così è come se l'<em>Attore</em> principale - un Guybrush, oppure un Indy - recitasse su di un palcoscenico virtuale, magari assieme a molti altri personaggi che, siano essi umani o non (animali, automobili, oggetti in movimento e così via), saranno comunque considerati come <em>Attori</em> anch'essi.</p>


<!-- <div class="dashed-border" style="padding: 1em;"> -->
<h3>Camera</h3>
<p>Continuando le nostre similitudini possiamo dire che, come per il cinema, anche per il gioco esiste la <b>camera</b> (telecamera o macchina da presa che dir si voglia): quella che riprende l'azione dallo stesso punto di vista del giocatore.</p>
<p>Il giocatore, seduto di fronte allo schermo, osserva lo svolgersi delle azioni come se stesse assistendo ad una proiezione cinematografica. L'immagine che il giocatore osserva sul proprio schermo, altro non è che l'immagine ripresa da questa <em>camera</em> virtuale.</p>
<p>La <em>camera</em> si può muovere eseguendo carrellate laterali, verticali, oppure può anche seguire i movimenti di un dato <em>Attore</em>.</p>

<table class="img">
<tr>
  <td>
  <img alt="camera-azzorre" src="http://www.limulo.net/images/scumm/camera-azzorre.gif" />
  </td>
  <td>
  <img alt="camera-ascensore" src="http://www.limulo.net/images/scumm/camera-ascensore.gif" />
  </td>
</tr>

<tr>
  <td>La camera può eseguire carrellate laterali,</td>
  <td>oppure verticali!</td>
</tr>

<tr>
  <td>
  <img alt="camera-scabb" src="http://www.limulo.net/images/scumm/camera-scabb.gif" />

  </td>
  <td>
  <img alt="camera-newyork" src="http://www.limulo.net/images/scumm/camera-thera.gif" />
  </td>
</tr>

<tr>
  <td colspan= 2 >La camera può inoltre seguire i movimenti dell'attore nella scena.</td>
</tr>
</table>

<!-- </div> -->

<div class="separatore"></div>

<!--    
<p>Abbiamo detto che l'<em>Attore</em> è una entità astratta, essa conserva molti dati utili alla logica di gioco, come la posizione dell'<em>attore</em> in scena, la direzione in cui sta guardando, le velocità di spostamento, le dimensioni, eppure noi non saremmo in grado di vederlo se, tra le altre cose, l'attore non possedesse anche un proprio <b>Costume</b>.</p>

<p>Ebbene sì, l'Attore senza il <em>Costume</em> sarebbe "nudo"; e si potrebbe dire di più: un attore, talvolta con un po' di incoraggiamento (<b>*</b>), può anche cambiare il proprio <em>costume</em> nel corso del gioco!</p>  

<h3>Costume</h3>
<p>Abbiamo detto che l'attore è un'entità astratta, esso, per poter essere "visto" a schermo, ha bisogno di vestirsi: quale termine più adatto allora se non quello di <em>Costume</em>!</p>

<p>Costume è un concetto leggermente più concreto rispetto a quello dell'attore, legato a quello di immagine.</p>
<p>All'attore si associano una o più immagini che ne mostrano i vari stati e movimenti. Queste immagini sono gestite tramite il <em>Costume</em>.</p>
<p>E' probabile che un attore di importanza secondaria possieda pochi costumi da poter "indossare", è invece molto più probabile che un'attore principale abbia un "guardaroba" molto più ricco!</p>

<p>TODO: alcuni costumi sono fissi, altri sono invece animati?</p>

<p>Dal momento che il <em>Costume</em> è una collezioni di animazioni (ma anche di disegni singoli), spesso può essere necessario metterne in riproduzione una piuttosto che un'altra in relazione alle interazioni che l'<em>Attore</em> ha con l'ambiente circostante.</p>

<table style="width: 100%;">
<tr>
  <td>In altri casi può succedere che gli script del gioco forzino un attore a cambiare del tutto il proprio <em>Costume</em> e caricare così un set di disegni completamente nuovo (come ad esempio accade quando Indy si cambia d'abito all'interno del sommergibile tedesco).</td>
  <td>
    <img alt="cambio abito" src="http://www.limulo.net/images/scumm/cambio-abito.gif" />
  </td>   
  <td>
    <img alt="abito 1" src="http://www.limulo.net/images/scumm/abito-1.png" />
    <img alt="abito 2" src="http://www.limulo.net/images/scumm/abito-2.png" />
  </td> 	
</tr>
</table>

<p>ScummVM offre alcuni comandi da console per forzare il caricamento di costume, a scopo di debug.<br>Vedremo questi comandi in dettaglio in un futuro post ma intanto eccovi un nuovo video per meglio capire di cosa stiamo parlando:</p>

<div class="nota">
TODO: link ad articolo comandi Console
</div>

<p>TODO: inserimento del video Youtube serie SCUMM Under the hood ep.2</p>

<div class="dashed-border">
<p>Se volete fare anche voi qualche prova, vi lascio qui alcune indicazioni:</p>
<ul>
  <li>Avviate ScummVM e caricate una partita di un gioco a vostra scelta!</li>
  <li>sulla tastiera del computer premete la combinazione di tasti <img alt="Ctrl" src="http://www.limulo.net/images/scumm/Ctrl.jpg"> + <img alt="D" src="http://www.limulo.net/images/scumm/D.jpg"> per passare alla console di Debug;</li>
  <li>digitate il comando <span class="code">actors</span> e date l'invio per visualizzare in output una tabella che mostri le informazioni su tutti gli attori in scena;</li>
  <li>digitate il comando <span class="code">actor &lt;actorId> name</span>, sostituendo l'identificativo numerico dell'attore in vece di <span class="code">&lt;actorId></span>, quindi date l'invio. Otterrete così il nome dell'attore sotto forma di stringa in output;</li>
  <li>per effettuare un cambio di <em>Costume</em>, usate il comando <span class="code">actor &lt;actorId> costume &lt;costumeId></span> sostituendo l'identificativo numerico del costume da far indossare all'attore;</li>
  <li>infine premete <img alt="ESC" src="http://www.limulo.net/images/scumm/Esc.jpg"> per tornare al gioco;</li>
</ul>

<br>

<div class="nota">
<p><b>ATTENZIONE</b>: usate questi comandi a vostro rischio e pericolo! Per esperienza personale posso dire che talvolta il loro uso può comportare il crash della macchina virtuale!</p>
</div>

<p>Ecco, ad esempio, i comandi che abbiamo usato nel video mostrato poco più sopra:</p>
<ul>
  <li><span class="code">actor 3 costume 86</span> - l'attore <em>Hoagie</em> indossa il costume da domestica!</li>
<li><span class="code">actor 3 costume 95</span> - ora è un gatto!</li>
  <li><span class="code">actor 3 costume 63</span> - ora invece siamo George Washington</li>
</ul>

<p>Provate ad indossare il costume 83 oppure il 107, il 110, 119, 129, 5, 6, 51, 52...</p>       
</div>

<h3>Room</h3>        
<p>Veniamo ora al palcoscenico! Ebbene sì, per indicare il luogo fisico su cui gli attori recitano e interagiscono tra loro e con altri oggetti lì presenti si usa il termine <em>Room</em>.</p>

<p>Per diverso tempo devo dire, ho fatto fatica a capire il perchè venisse usato questo termine; forse mi sarebbe sembrato più sensato sostituirlo con <em>livello</em>, <em>sfondo</em>, <em>set</em> o <em>stage</em>, non avrei certo usato <em>stanza</em>, anche perchè ci sono certe situazioni in cui gli attori tutto fanno tranne che muoversi all'interno di una <em>stanza</em>:</p>

<table class="img" style="width: 100%;">
<tbody>
    <tr>
        <td>
            <img alt="loom room image" src="http://www.limulo.net/images/scumm/room-loom.png" />
        </td>
        <td>
            <img alt="indy room image" src="http://www.limulo.net/images/scumm/room-indy.png" />
        </td>
    </tr>
  <tr>
        <td>
            <img alt="monkey2 room image" src="http://www.limulo.net/images/scumm/room-monkey2.png" />
        </td>
        <td>
            <img alt="zack room image" src="http://www.limulo.net/images/scumm/room-zack.png" />
        </td>
    </tr>
</tbody>
</table>

<p>Il termine venne usato per la prima volta nella versione 1.0 di SCUMM (interprete usato per <b>Maniac Mansion</b>) e da allora non subì più alcuna successiva modifica e rimase tale in tutte le versioni seguenti, seppur con una accezzione molto più generale.</p>
<p>In <b>Maniac Mansion</b> infatti i protagonisti si muovono esclusivamente all'interno di stanze!</p>   

<div>
<img alt="maniac room image" src="http://www.limulo.net/images/scumm/room-maniac.png" style="width: 100%;">
</div>

<h3>Cut-scene</h3>
<p>Il termine <b>Cut-scene</b> identifica tutti quei momenti del gioco in cui l'azione, o per meglio dire l'interazione, viene interrotta.<br>Sul palco continuano ad esserci attori in movimento che parlano tra loro e si muovono, l'unica differenza rispetto ad una condizione di gioco normale è che il giocatore non è in grado di influenzare il loro comportamento. Infatti un tipico segno caratteristico delle cut-scene è che il cursore del mouse "sparisce", per poi ricomparire al termine della sequenza.</p>    
<p>Durante le cut-scenes, l'interazione viene momentaneamente interrotta per dare spazio a momenti più narrativi che servono a portare avanti la storia.</p>
-->

Bene, per oggi è tutto; la prossima volta continueremo ad arricchire il nostro vocabolario!

<div class="author">Nicola</div>
<!--
<h3>Riferimenti</h3>

<p><b>Links</b></p>
<ul>
    <li><a class="ext" href="" target="_blank"></a>;</li>
</ul>
-->
<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>



<article>
<header>
<a id="risorse"></a>
<h2>Risorse</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>

<p>Sono 2 i contenitori di infomrazioni principali <b>Index File</b> e <b></b>.</p>

<h3>Index File</h3>

<p>L'<b>Index File</b> SCUMM contiene speciali informazioni per permettere un accesso randomico alle risorse all'interno degli altri files del gioco. QUesto files contiene, tra le atre cose, anche i nomi delle room e i limiti massimi per il gioco.</p>
<p>Sono quelli mostrati qui di seguito i nomi di file che si usano per identificare i files di indice:


<p>cosa si vede in maniac mansion  / cosa in Indy / cosa in Day Of The Tentacle / cosa Full Throttle</p>

<table>
<tr>
    <td>filename</td>
    <td>SCUMM version</td>
</tr>
<tr>
    <td>00.lfl / 000.lfl</td>
    <td>V3/4</td>
</tr>
<tr>
    <td>.000</td>
    <td>V5/6</td>
</tr>
<tr>
    <td>.LA0</td>
    <td>V7/8</td>
</tr>
</table>

<p>A Chunk is a named part of the file, e.g. RNAM. Each chunk has a header that contains at least the chunk name and its size. The following chunks are available: </p>

<table>
    <tr>
        <td>RNAM</td>
        <td>Room Names</td>
    </tr>
    <tr>
        <td>MAXS</td>
        <td>Maximum Values</td>
    </tr>
    <tr>
        <td>DROO</td>
        <td>Directory of Rooms</td>
    </tr>
    <tr>
        <td>DSCR</td>
        <td>Directory of Scripts</td>
    </tr>
    <tr>
        <td>DSOU</td>
        <td>Directory of Sounds</td>
    </tr>
    <tr>
        <td>DCOS</td>
        <td>Directory of Costumes</td>
    </tr>
    <tr>
        <td>DCHR</td>
        <td>Directory of Charsets</td>
    </tr>
    <tr>
        <td>DOBJ</td>
        <td>Directory of Objects</td>
    </tr>
</table>



<h3>L'altro file</h3>

<div class="author">Nicola</div>

<h3>Riferimenti</h3>

<p><b>Links</b></p>
<ul>
    <li><b>[a]</b> ScummVM Technical Reference, <a class="ext" href="http://wiki.scummvm.org/index.php/SCUMM/Technical_Reference/Index_File#Scumm_5" target="_blank">Index File</a>;</li>
</ul>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>








<article>
<header>
<a id="debugger"></a>
<h2>SCUMM & ScummVM Debugging</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>

<p>Come si può leggere nel WiKi del progetto ScummVM <b>[a]</b> e <b>[b]</b>, i giochi della LucasArts possiedono delle password e delle combinazioni di tasti per effettuare il controllo degli errori all'interno del gioco.<br>Questo tipo di <em>debug</em> viene escluso dal sistema ScummVM: queste combinazioni e password non funzionano se il gioco è giocato al suo interno, tuttavia è ancora possibile vederle in azione se si fa uso degli eseguibili Dos originali (ad esempio tramite DOSBox).</p>

<p>Per il gioco <b>Indiana Jones and the Fate of Atlantis</b> ad esempio, occorre inserire prima di tutto una password (<b>debug pasword</b>) alla quale viene fatta seguire una prima combinazione di tasti (<b>activation key</b>), per attivare la modalità di <em>debug</em> e poi una seconda combinazione, per effettuare il controllo o la modifica del comportamento del gioco.</p>

<p>Sul WiKi <b>[b]</b> sono riportate tutte le informazioni relative alle modalità di debug per i vari giochi LucasArts. In questo articolo ci concentreremo sul mio favorito 'Indiana Jones And the Fate of Atlantis'.</p>

<p>La password deve essere inserita esattamente così com'è, a seguire, una combinazione di attivazione va fatta seguire per entrare a tutti gli effetti nella modalità debug!</p>

<div class="dashed-border" style="padding: 1em;">
<p></p>

<p><b>Debug Password</b>: shinymetal</p>
<p><b>Activation Key</b>: <b><img alt="Ctrl" src="http://www.limulo.net/images/scumm/Ctrl.jpg"> + <img alt="Shift" src="http://127.0.0.1/limulo.net/images/scumm/shift.jpg"> + <img alt="D" src="http://www.limulo.net/images/scumm/D.jpg"></b></p>
<p><b>Keys</b></p>
<ul>
    <li><b><img alt="Ctrl" src="http://www.limulo.net/images/scumm/Ctrl.jpg"> + <img alt="E" src="http://127.0.0.1/limulo.net/images/scumm/E.jpg"> =</b> Set variable ;</li>
    <li><b><img alt="Ctrl" src="http://www.limulo.net/images/scumm/Ctrl.jpg"> + <img alt="F" src="http://127.0.0.1/limulo.net/images/scumm/F.jpg"> =</b> Fast mode ;</li>
    <li><b><img alt="Ctrl" src="http://www.limulo.net/images/scumm/Ctrl.jpg"> + <img alt="G" src="http://127.0.0.1/limulo.net/images/scumm/G.jpg"> =</b> Goto room ;</li>
    <li><b><img alt="Ctrl" src="http://www.limulo.net/images/scumm/Ctrl.jpg"> + <img alt="O" src="http://127.0.0.1/limulo.net/images/scumm/O.jpg"> =</b> Pick up object in room x ;</li>
    <li><b><img alt="Ctrl" src="http://www.limulo.net/images/scumm/Ctrl.jpg"> + <img alt="L" src="http://127.0.0.1/limulo.net/images/scumm/L.jpg"> =</b> Enter a bootparam ;</li>
</ul>
</div>

<p>La console di ScummVM si abilita tramite la combinazione di tasti <img alt="Ctrl" src="http://www.limulo.net/images/scumm/Ctrl.jpg"> + <img alt="D" src="http://www.limulo.net/images/scumm/D.jpg"> . <br>Si tratta di una console interattiva che permette di controllare e manipolare i dati utilizzati dall'engine di gioco in tempo reale. Molto utile per fare debug ed esperimenti vari!</p>

<p>Dall'esperienza personale posso dire che talvolta la manipolazione di questi dati può comportare il crash della macchina virtuale! Usate questi comandi a vostro rischio e pericolo :)!</p>

<h3>Comandi di Default</h3>

<p>I comandi di default che la console fornisce sono (per l'interprete ScummVM v. 1.7):</p>
<ul>
    <li><b>help</b> : Display the list of available commands;</li>
    <li><b>exit</b> : Exit the debug console;</li>
    <li><b>debugflag_list</b> : list the available debug flags and their status;</li>
    <li><b>debugflag_enable &lt;debugflag></b> : enable a given debugflag;</li>
    <li><b>debugflag_disable &lt;debugflag></b> : disable a given debugflag;</li>
</ul>

<p>Questi comandi sono poi estesi con ulteriori comandi dipendenti dall'engine del gioco specifico che con cui si sta giocando.</p>

<h3>Comandi Specifici</h3>

<p>Utilizzando L'interprete ScummVM ver. 1.7 e giocando a Indiana Jones and the Fate of Atlantis ver 1.0, ecco quali sono i comandi (come vedere la versione dell'engine o del videogioco? ecco il <a href="#ver">post</a> dedicato !):</p>

<table class="dati">
  <tr><td>actor</td>		<td>hide</td>		<td>objects</td>	<td>savegame</td>	</tr>
  <tr><td>actors</td>		<td>importres</td>	<td>openlog</td>	<td>src</td>		</tr>
<tr><td>box</td>		<td>imuse</td>		<td>quit</td>		<td>script</td>		</tr>
<tr><td>camera</td>		<td>loadgame</td>	<td>resetcursor</td><td>scripts</td>	</tr>
<tr><td>continue</td> 	<td>matrix</td>		<td>restart</td>	<td>show</td>		</tr>
<tr><td>debuglevel</td> <td>object</td>		<td>room</td>		<td> </td>			</tr>
</table>

<p>le variabili sono invece</p>
<ul>
<li>debug_countdown</li>
<li>scumm_speed</li>
<li>scumm_room</li>
<li>scumm_roomresource</li>
<li>scumm_vars</li>
</ul>
<p>(vedremo poi quale sia il loro utilizzo)</p>

<h3>Riferimenti</h3>

<p><b>Links</b></p>
<ul>
    <li><b>[a]</b> <a class="ext" href="http://wiki.scummvm.org/index.php/SCUMM/Debug_Codes" target="_blank">SCUMM Debug Codes</a>;</li>
<li><b>[b]</b> <a class="ext" href="http://wiki.scummvm.org/index.php/Debugging_ScummVM" target="_blank">Debugging ScummVM</a>;</li>
</ul>


<h3>ANALISI DEI COMANDI di DEBUG per l' ENGINE</h3>

<div>
<h3>ACTOR</h3>
<p><b>Syntax</b>:</p>
<p class="code">actor &lt;actornum> &lt;command> &lt;parameter></p>
<p><b>Description</b>:</p>
<p>modifica il comportamento di un attore. Utilizza un valore molto alto per "actornum" così da ottenere un warning che indica il numero massimo di attori disponibili</p>
<p><b>Comandi</b>:</p>
<ul>
<li>"animvar" - ???</li>
<li>"anim" - ???</li>
<li>"ignoreboxes" - permette all'attore di ignorare le costrizioni dettate dalle walk boxes e camminare a piacimento ovunque.</li>
<li>"x" - impostare la posizione x</li>
<li>"y" - impostare la posizione y</li>
<li>"_elevation" - impostare il valore di elevazione</li>
<li>"costume" - settare una apparenza grafica differente per l'attore (utilizza un valore alto per mostrare il numero di costumes available)</li>
<li>"name" - per mostrare il nome dell'attore</li>
<li>"condmask" - ???</li>
</ul>
<p><b>Esempio</b>:</p>
<ul>
<li class="code">actor 1 costume 3</li>
<li class="code">actor 1 ignoreboxes 1/0</li>
</ul>
</div>		


<div>
<h3>ACTORS</h3>
<p><b>Syntax</b>:</p>
<p class="code">actors</p>
<p><b>Description</b>:</p>
<p>mostra una tabella che riporta tutte le informazioni relative a tutti gli attore presenti sulla scena.<br>
TODO : riporta un esempio di tabella e spiega quali siano i significati per ogni grandezza e variabile riportata.</p>
</div>

<div>
<h3>ROOM</h3>
<p><b>Syntax</b>:</p>
<p class="code">room<br>
room &lt;roomnum></p>
<p><b>Description</b>:</p>
<p>Mostra il numero identificativo della room corrente. Se si specifica un valore numerico subito dopo il comando 'room', è possibile cambiare room istantaneamente nonappena si ritorna al gioco.</p>
</div>


<div>
<h3>SCRIPTS</h3>
<p><b>Syntax</b>:</p>
<p>scripts</p>
<p><b>Description</b>:</p>
<p>Mostra la lista degli script e relativi dati per la room corrente.</p>
</div>

<div>
<h3>SCRIPT</h3>
<p><b>Syntax</b>:</p>
<p class="code">script &lt;scriptnum> &lt;command></p>
<p><b>Description</b>:</p>
<p>il comando permette di agire sull'esecuzione degli script della room. I comandi che possono essere usati sono kill/stop oppure run/start.</p>
</div>


<div>
<h3>DEBUG</h3>
<p><b>Syntax</b>:</p>
TODO: riordinare le cose che scrivo
usa DEBUG per vedere quali siano i flag disponibili per subire il debug.
apri la console per permettere visualizzare output del debugger.
indica quale canale di debugger preferisci analizzare attraverso l'uso del comando DEBUGFLAG_ENABLE o DEBUGFLAG_DISABLE
<p><b>Description</b>:</p>
</div>


<div>
<h3>DEBUGLEVEL</h3>
<p><b>Syntax</b>:</p>
<p class="code">debuglevel &lt;level></p>
<p><b>Description</b>:</p>
<p>specificando un livello di debug compreso tra 0 e 10 per ricevere debug in uscita<br>
specifica un livello -1 per annullare il debug.</p>
</div>		


<div>
<h3>OBJECT</h3>
<p><b>Syntax</b>:</p>
<p class="code">object &lt;objectnum> &lt;command> &lt;parameter></p>
<p><b>Description</b>:</p>
<p>i comandi possono essere 'pickup', 'state' oppure 'name'.<p>
<pre>
"pickup" BUG?
00497         if (argc == 3)
00498             _vm->addObjectToInventory(obj, _vm->_currentRoom);
00499         else
00500             _vm->addObjectToInventory(obj, atoi(argv[3]));
</pre>
</div>

<div>
<h3>OBJECTS</h3>
<p><b>Syntax</b>:</p>
<p class="code">objects</p>
<p><b>Description</b>:</p>
<p>mostra i dati degli oggetti presenti nella room corrente.</p>
</div>

<div>
<h3>CAMERA</h3>
<p><b>Syntax</b>:</p>
<p class="code">camera</p>
<p><b>Description</b>:</p>
<p>Mostra i dati relativi alla camera nel formato "cur (%d,%d) - dest (%d,%d) - accel (%d,%d) - last (%d,%d)"</p>
</div>

<div>
<h3>SRC</h3>
<p>???</p>
</div>

<div>
<h3>IMPORTRES</h3>
<p><b>Syntax</b>:</p>
<p class="code">importres &lt;restype> &lt;filename> &lt;resnum></p><p>??????</p>
        <p>"scr" ???</p>
        <p><b>Description</b>:</p>
<p>drafts Command only works with Loom/LoomCD</p>
</div>

<div>
<h3>LOADGAME</h3>
<p><b>Syntax</b>:</p>
<p class="code">loadgame &lt;slotnum></p>
<p><b>Description</b>:</p>
<p>???</p>
</div>

<div>
<h3>SAVEGAME</h3>
<p><b>Syntax</b>:</p>
<p class="code">savegame &lt;slotnum></p>
<p><b>Description</b>:</p>
<p>???</p>		
</div>

<div>
<h3>SHOW</h3>
<p><b>Syntax</b>:</p>
<p class="code">???</p>
   	<p>"hex" ,  "sta" (for STACK dumping) ???</p>
<p><b>Description</b>:</p>
<p>???</p>
</div>

<div>
<h3>HIDE</h3>
<p><b>Syntax</b>:</p>
<p class="code">???</p>
<p>"hex" ,  "sta" (for STACK dumping) ???</p>
<p><b>Description</b>:</p>
<p>???</p>
</div>

<div>
<h3>IMUSE</h3>
<p><b>Syntax</b>:</p>
<p class="code">???</p>
<p>"panic" - Stop all music tracks, "play" &lt;number|"random">, "stop" &lt;number|"all"></p>
<p><b>Description</b>:</p>
<p>???</p>
</div>



<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>    







<article>
<header>
<a id="room"></a>
<h2>SCUMM Room System</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>
<p>Le room perchè si chiamano così? Di sicuro si può traovare la spiegazione di questo nel fatto che, con SCUMM creato per supportare la creazione del gioco Maniac Mansion, in cui i protagonisti, di fatto, vagano all'interno di una casa, la varie parti del gioco altro non sono che delle vere e proprie stanze, <em>room</em> appunto!</p>
<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>



<article>
<header>
<a id="actor"></a>
<h2>SCUMM Actor System</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>
<p>chi sono gli attori?</p>
<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>



<article>
<header>
<a id="scripts"></a>
<h2>SCUMM Scripts pt.1</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>
<p>vedi: http://www.pagetable.com/?p=603</p>
<p>http://www.pagetable.com/?p=614</p>
<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>



<article>
<header>
<a id="json"></a>
<h2>Curiosità: LucasFilm Games e JSON</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>

<div>
<img src="http://www.limulo.net/images/logos/json-logo.jpg" alt="Json logo" style="float: left; width: 10%;"/>
<p>Fino ad oggi non sapevo che lo standard di interscambio dati <b>JSON</b> fosse stato specificato per la prima volta da Douglas Crockford, e in tutta sincerità, non sapevo nemmeno chi fosse questo Douglas Crockford.</p>

<p>A quanto pare lavorò per la LucasFilm Games nell'epoca d'oro; si fece carico del riadattamento del gioco <b>Maniac Mansion</b> per l'uscita su NES. Il compito non fu affatto facile visti gli standard della <b>Nintendo</b> dell'epoca: molto restrittivi e in certi casi anche molto discutibili.</p>
<hr class="clear" />
</div>

<p>A tale proposito datevi una letta a questo simpatico articolo che lo stesso Crockford ha scritto per raccontare i particolari più curiosi di quella esperienza: "<b>The Expurgation of Maniac Mansion for the Nintendo Entertainment System</b>" <b>[a]</b>!</p>

<h3>Riferimenti</h3>
<p><b>Links</b></p>
<ul>
    <li>da Wikipedia: <a class="ext" href="https://en.wikipedia.org/wiki/JSON" target="_blank">JSON</a>, <a class="ext" href="https://en.wikipedia.org/wiki/Douglas_Crockford" target="_blank">Douglas Crockford</a>;</li>
    <li><a class="ext" href="http://json.org/" target="_blank">Official page</a>;</li>
    <li><b>[a]</b> <a class="ext" href="http://www.crockford.com/wrrrld/maniac.html" target="_blank">The Expurgation of Maniac Mansion for the Nintendo Entertainment System</a> by Douglas Crockford</li>
</ul>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>             



<article>
<header>
<a id="boxes-walk-matrix"></a>
<h2>Boxes and Walk Matrix</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>

<p>Tutto è cominciato quando ho cercato di capire che tipo di algoritmo usasse SCUMM per muovere i vari attori all'interno della room</p>
<p>Ad ogni click l'attore, lo SCUMM engine individua un percorso e l'attore comincia a muoversi, camminando verso il punto in cui si è cliccato, aggirando gli ostacoli presenti. Come è possibile tutto questo?</p>
<p>La letteratura<b>[1]</b> tratta approfonditamente l'argomento, indicando diversi tipi di algoritmi che si usano per risolvere problemi di questo tipo, detti problemi del <em>pathfinding</em>. il più conosciuto è forse <b>A*</b>.</p>

<p><br/></p>

<div class="nota">
<img alt="Edsger Dijkstra" src="http://www.limulo.net/images/scumm/Dijkstra.jpg" style="float: right;" />
<p>Come riporta <b>[1]</b>, l'algoritmo <b>A*</b> è una naturale evoluzione del più semplice algorimo di <b>Dijkstra</b>. Quest'ultimo viene più spesso utilizzato per risolvere problemi di <em>tactical decision making</em> piuttosto che per il <em>pathfinding</em>.</p>
<p>L'agoritmo di Dijkstra prende il nome dal suo scopritore, il matematico Edsger Dijkstra. Originariamente progettato per risolvere un problema nella teoria matematica dei grafi, un problema detto dello <em>shortest path</em>, questo algoritmo è stato poi messo al servizio del videogioco ed è diventato il punto di partenza per la risoluzione di una particolare classe di problemi.</p>
<p>Tra le altre cose, proprio il sig. Dijkstra, con il suo celebre articolo <em>"GOTO statement considered harmful"</em> <b>[b]</b> del 1968, si batteva contro lo <em><b>Spaghetti code</b></em>, ossia contro i programmi di scarsa qualità, difficilmente leggibili e modificabili per la malsana tendenza all'uso della direttiva <b>GOTO</b> (vedi <b>[c]</b>).</p>
<hr class="clear" />
</div>

<p><b>A*</b> tuttavia è un algoritmo abbastanza complesso e articolato per essere utilizzato all'interno di SCUMM, a causa forse delle limitazioni computazionali dei dispositivi dell'epoca? non saprei dire, fatto sta che SCUMM utilizza invece un sistema molto più semplice e, in questa sua semplicità, direi molto elegante!</p>


<h3>Fingolfin Docet</h3>

<p>Per meglio capire in cosa consiste questo sistema voglio citare le parole di <b><em>Max "Fingolfin" Horn</em></b>, ormai ex-membro del team di sviluppo di ScummVM, direttamente tratte da un suo intervento (vedi <b>[a]</b>) sul forum:</p>

<div class="traduzione dashed-border">

<p>ScummVM doesn't using anything complicated like A* at all!</p>

<p>Rather, the game screen is divided into so-called "boxes" (which in the later SCUMM versions could essentially be almost arbitrary non-overlapping quadrangles).</p>

<p>Normally, an "actor" (like e.g. Guybrush in Monkey Island) is confined to movement within those boxes. So at any time, an actor has a "current box" attribute assigned to it. Let's assume the actor is in box 1.</p>

<p>When the user clicks somewhere, the engine first determines which box the click was in. If it's the same as the actor to be moved is in anyway, it can just be walked there. That's easy. Now assume the click was in a different box, e.g. box 5. THen the engine first determines how to get to that box. For this, it looks in the "box matrix", which is essentially a precomputed n*n matrix, where n is the total number of boxes in the room. For each pair (i,j) of boxes, it contains a value k which says: "If you are in box i and want to get to get to box j, first go to box k". Note that "k" could equal j if box i and j are adjacent.<br>
Now, equipped with this value, the engine will first compute a path for the actor to walk from its current position to the new box k. This depends on how the boxes i and k "touch".</p>
<p>Anyway, so the actor walks a bit and reaches box k. If this was the same as the box of our final destination, then we just walk to the final destination, and are done. If not, we rince and repeat: Look up the entry (k,j) in the box matrix to find the next box; walk to that; etc.</p>

<p>[...]</p>

</div>

<p><b>Fingolfin</b> dice sostanzialmente che l'area di gioco è suddivisa in aree quadrangolari non sovrapposte, chiamate <b>boxes</b>.</p>
<p>I movimenti dell'<b>attore</b> (come ad esempio Indiana Jones) sono confinati all'interno di queste aree (per questo, l'attore possiede un attributo denominato <b>current box</b>).</p>

<p>Quando l'utente clicca, per prima cosa l'engine determina in quale box è avvenuto il click. Se il click è avvenuto nella stessa box in cui risiede l'attore, l'attore camminerà verso il punto del click, semplicemente.</p>

<p>TODO: e se il click avviene al di fuori di tutte le box??</p>

<p>Se invece il click è avvenuto in una box differente, allora l'engine deve dapprima determinare come poterci arrivare. Per farlo consulta la <b>box matrix</b> (anche chiamata <b>walk matrix</b>), che è essenzialmente una matrice precostruita di <b>n</b>*<b>n</b> elementi, dove <b>n</b> è il numero totale di box nella room.</p>

<p>Per ogni coppia di box (<b>i</b>, <b>j</b>) la matrice contiene un valore <b>k</b> che sta a significare:</p>
<p style="text-align: center">"<em>Se ti trovi nella box </em><b>i</b><em> e vuoi raggiungere la </em><b>j</b><em>, raggiungi prima la </em><b>k</b>"</p>
<p>da notare che <b>k</b> può anche essere uguale a <b>j</b> se <b>i</b> e <b>j</b> sono adiacenti.</p>

<p>Ora, a partire da questo valore, l'engine deve occuparsi di calcolare un percorso per l'attore per condurlo dalla sua posizione attuale alla box <b>k</b>. Questo dipende dal modo in cui le due box, <b>i</b> e <b>k</b> sono affiancate.</p>
<p>Una volta che l'attore ha raggiunto la box <b>k</b> si valuta se sia questa la box che contiene la destinazione finale:</p>
<ul>
    <li>Se sì, allora all'attore basterà muovere pochi ulteriori passi per raggiungere quel punto.</li>
    <li>Se no il procedimento ricomincia: si consulta la <b>box matrix</b> cercando l'entry associata alla nuova coppia (<b>k</b>, <b>j</b>), si ricava la prossima box, e si cammina fino a là, etc...</li>
</ul>


<h3>In pratica...</h3>
<p>Wow, tutto questo è molto interessante ma forse un poco troppo astratto. Vogliamo fare un esempio un po' più concreto?</p>
<p>Possiamo usare ScummVM e sperimentare con il suo debugger. Sotto allora e carichiamo un salvataggio da <b>Indiana Jones and the Fate of Atlantis</b>.</p>
<p>Carichiamo il salvataggio <em>Tikal</em> ed entriamo nel templio.</p>

<div class="img">
<img alt="tikal" src="http://www.limulo.net/images/scumm/tikal.png" />
</div>

<p>Una volta qui, richiamiamo il debugger di ScummVM con la combinazione di tasti <img alt="Ctrl" src="http://www.limulo.net/images/scumm/Ctrl.jpg"> + <img alt="D" src="http://www.limulo.net/images/scumm/D.jpg"></p>

<p>Il debugger di ScummVM offre 2 principali comandi per esaminare le informazioni di cui abbiamo parlato; esaminiamoli nel dettaglio:</p>
<ul>
    <li>comando <a href="#debugger-comando-box">box</a>;</li>
    <li>comando <a href="#debugger-comando-matrix">matrix</a>.</li>
</ul>

<p>VIDEO</p>

<a id="debugger-comando-box"></a>
<h3>Comando BOX</h3>
<p>Il comando <b>box</b> mostra un resoconto delle più importatnti informazioni relative alle box della room corrente, proviamo a digitarlo a console e a dare l'invio: ecco qui quanto riportato dall'output:</p>

<div class="img">
<img alt="tikal boxes" src="http://www.limulo.net/images/scumm/console-01.png" />
</div>

<p>12 righe di testo in output, una per ciascuna delle box presenti nella room (la room 0 sembra avere delle caratteristiche anomale e per il momento la tralascieremo). Le informazioni sono mostrate nella forma seguente (la versione SCUMM su cui questo gioco si basa è la 5, per altri giochi le informazioni mostrate potrebbero essere diverse):</p>

<table class="dati">
    <tr>
        <th>Upper Left Coords</th>
        <th>Upper Right Coords</th>
        <th>Lower Right Coords</th>
        <th>Lower Left Coords</th>
        <th>Mask</th>
        <th>Flags</th>
        <th>Scale</th>
    </tr>
</table>

<p>Tralasciando per ora gli ultimi tre campi (<b>Mask</b>, <b>Flags</b> e <b>Scale</b>) che tratteremo in articoli separati, concentriamoci ora sulle prime 4 coppie di valori.</p>

<div>
<img alt="box" src="http://www.limulo.net/images/scumm/box.jpg" style="margin: 1em; float: right;" />

<p>Ognuna di queste coppie altro non è che una coppia di coordinate espresse in <em>pixels</em> relative ai vertici della <b>box</b>, (ricordiano che la box altro non è se non un' area quadrangolare).</p>
<p>I vertici vengono indicati da quello più in alto a sinistra (<b>U</b>pper <b>L</b>eft) fino a quello che si trova in basso a sinistra (<b>L</b>ower <b>L</b>eft)procedendo in senso orario. Nell'ordine quindi si hanno i 4 vertici <b>UL</b>, <b>UR</b>, <b>LR</b> e infine <b>LL</b>, come mostrato nella figura qui di fianco.</p>

<hr class="clear" />
</div>

<div class="nota">
<p><br>ATTENZIONE: ricontrollare la sezioni qui sopra. Non sono convinto fino in fondo che i vertici della box vengano forniti in senso ORARIO!!!</p>
</div>

<p>Riportando i valori delle coordinate sull'immagine di sfondo otteniamo questa rappresentazione che rende subito l'idea di come siano fatte le box e di come esse siano disposte in modo tale da affiancarsi tra loro per creare, di fatto, l'intera area calpestabile dagli attori.</p>

<div class="img">
<img alt="tikal boxes" src="http://www.limulo.net/images/scumm/tikal-boxes-02.png" />
</div>

<div class="nota">
<p>Da notare inoltre un particolare interessante: come si può vedere dall'immagine, alcuni di questi quadrangoli possono degenerare in semplici linee se i loro vertici coincidono a 2 a 2. Nella room corrente è il caso delle box <b>7</b>, <b>8</b> e <b>9</b>.</p>
</div>

<a id="debugger-comando-matrix"></a>
<h3>Comando MATRIX</h3>
<p>Usiamo ora il comando <em>matrix</em>, eccone l'output:</p>

<div class="img">
<img alt="tikal boxes" src="http://www.limulo.net/images/scumm/console-02.png" />
</div>

<p>Visto così non è molto chiaro. Costruiamoci uno spreadsheet ricavando le informazioni necessarie in questo modo:</p>
<ul>
    <li>La prima riga della matrice (nell'output della console indicata da <b>1:</b>) ha per elementi:
        <ul>
            <li>il valore 1, situato all'incrocio con la colonna 1</li>
            <li>il valore 2, per le colonne dalla 2 alla 8;</li>
            <li>il valore 10, in corrispondenza della colonna 10;</li>
            <li>nessun valore specificato per le altre colonne (9 e 11);</li>
        </ul></li>
    <li>La seconda riga della matrice ha per elementi:
        <ul>
            <li>il valore 1, situato all'incrocio con la colonna 1</li>
            <li>il valore 2, situato all'incrocio con la colonna 2</li>
            <li>il valore 3, situato all'incrocio con la colonna 3</li>
            <li>il valore 4, situato all'incrocio con la colonna 4</li>
            <li>il valore 3, per le colonne dalla 5 alla 8;</li>
            <li>il valore 10, in corrispondenza della colonna 10;</li>
            <li>anche per questa riga, nessun valore specificato per le colonne 9 e 11;</li>
        </ul></li>
</ul>

<p>Proseguiamo così per le righe rimanenti e otteniamo la tabella mostrata qui di seguito.</p>

<table class="walk-matrix">
    <tr>
        <th class="gray1"> </th>
        <th>1</th>
        <th>2</th>
        <th>3</th>
        <th>4</th>
        <th>5</th>
        <th>6</th>
        <th>7</th>
        <th>8</th>
        <th>9</th>
        <th>10</th>
        <th>11</th>
    </tr>
    <tr>
        <th>1</th>
        <td class="gray1">1</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td class="gray2">//</td>
        <td>10</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>2</th>
        <td>1</td>
        <td class="gray1">2</td>
        <td>3</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td class="gray2">//</td>
        <td>10</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>3</th>
        <td>2</td>
        <td>2</td>
        <td class="gray1">3</td>
        <td>2</td>
        <td>5</td>
        <td>6</td>
        <td>7</td>
        <td>7</td>
        <td class="gray2">//</td>
        <td>2</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>4</th>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td class="gray1">4</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td class="gray2">//</td>
        <td>2</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>5</th>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td class="gray1">5</td>
        <td>6</td>
        <td>3</td>
        <td>3</td>
        <td class="gray2">//</td>
        <td>3</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>6</th>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td>5</td>
        <td class="gray1">6</td>
        <td>7</td>
        <td>7</td>
        <td class="gray2">//</td>
        <td>3</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>7</th>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td>6</td>
        <td class="gray1">7</td>
        <td>8</td>
        <td class="gray2">//</td>
        <td>3</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>8</th>
        <td>7</td>
        <td>7</td>
        <td>7</td>
        <td>7</td>
        <td>7</td>
        <td>7</td>
        <td>7</td>
        <td class="gray1">8</td>
        <td class="gray2">//</td>
        <td>7</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>9</th>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray1">9</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>10</th>
        <td>1</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td>2</td>
        <td class="gray2">//</td>
        <td class="gray1">10</td>
        <td class="gray2">//</td>
    </tr>
    <tr>
        <th>11</th>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray2">//</td>
        <td class="gray1">11</td>
    </tr>
</table>

<h3>Esercizi</h3>
<p>Per comodità, torno a mostrare l'immagine vista poco più su. Facciamo ora un paio di esperimenti come se fossimo noi l'engine di gioco e dovessimo risolvere il problema del <em>pathfinding</em>!</p>

<div class="img">
<img alt="tikal boxes" src="http://www.limulo.net/images/scumm/tikal-boxes-02.png" />
</div>

<p>Supponiamo che l'attore Indy si trovi sulla box <b>1</b> (Indy->currente box = 1).<br>Supponiamo di cliccare in corrispondenza della box <b>4</b>, la nostra <em>final destination</em> si trova all'interno della box 4 (target box = 4). Come raggiungerla?<br>Consultiamo la <b>Walk Matrix</b> e leggiamo il valore in corrispondenza dell'incrocio riga-colonna 1-4. <br>Il valore che leggiamo è <b>2</b>.<br>Bene! questo significa che Indy, per riuscire a raggiungere 4 partendo da 1 deve dapprima passare per 2, come per altro ci conferma anche l'immagine qui sopra: la box 1 è affiancata alla 2.<br>Dopo una breve passeggiata Indy si trova ora sulla box 2 (Indy->currente box = 2). <br>La box attuale corrisponde alla nostra <em>target box</em>? La risposta è no, per cui l'operazione va ripetuta.<br>Consultiamo di nuovo la <b>Walk Matrix</b>, questa volta leggiamo il valore all'incrocio della riga 2 e della colonna 4: il valore letto è 4.<br>Ancora una volta, interpretare la tabella sottoforma di immagine ci rende pù semplice la comprensione: la box 4 è affiancata alla 2!<br>Basta un'altra semplice passeggiata per far sì che Indy passi dalla box 2 alla 4 e, infine, raggiunga senza ulteriori sforzi la nostra <em>final destination</em>.</p>
<p>Provate ora con un altro esperimento, provate a "cliccare" sulla box <b>6</b>. Consultate la tabella, riuscite a ricostruire il ragionamento dell'engine in questo caso?</p>

<div class="author">Nicola</div>


<h3>Riferimenti</h3>
<p><b>Books and Papers</b></p>
<ul>
    <li><b>[1]</b> Millington, I., & Funge J. (2009). <a class="ext" href="http://ai4g.com/" target="_blank">Artificial Intelligence for Games</a> (2nd ed.). Morgan Kaufmann.</li>
</ul>

<p><b>Links</b></p>
<ul>
    <li><b>[a]</b> ScummVM Forum pathfinding <a class="ext" href="http://forums.scummvm.org/viewtopic.php?t=4532" target="_blank">topic</a>;</li>
    <li><b>[b]</b> <a class="ext" href="https://www.cs.utexas.edu/users/EWD/ewd02xx/EWD215.PDF" target="_blank">Go-to statement considered harmful</a>;</li>
    <li><b>[c]</b> da Wikipedia: <a class="ext" href="https://en.wikipedia.org/wiki/Spaghetti_code" target="_blank">Spaghetti Code</a>, <a class="ext" href="https://en.wikipedia.org/wiki/Structured_programming" target="_blank">Programamzione Strutturata</a>;</li>
    <li><b>[d]</b> ScummVM, SCUMM technical reference: <a class="ext" href="http://wiki.scummvm.org/index.php/SCUMM/Technical_Reference/Box_resources" target="_blank">Box resources</a>;</li>
</ul>
<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>



<article>
<header>
<a id="tools-01"></a>
<h2>Tools per creare</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>

<p>Come gli stessi creatori del sistema SCUMM hanno raccontato (vedi <b>[a]</b> e <b>[b]</b>), il sistema <b>SCUMM</b> era molto più che un linguaggio di scripting, una modalità di codifica e di un interprete. Il sistema SCUMM in realtà comprendeva anche una serie di altri tools appositamente progettati per facilitare il lavoro degli sviluppatori e anche quello degli artisti, il cui compito era quello di preparare i vari assets dei giochi.</p>


<p>Scherzosamente gli sviluppatori Lucas avevano deciso di assegnare ad ognuno di questi tools nomi corrispondenti ad un ben preciso fuido corporeo!</p>
<p>Ed è così che si potevano vedere in funzione applicativi come MMUCUS, SPIT, FLEM, BYLE, CYST...

<p><b>SPIT</b></p>
<p>SPIT era un semplice editor di font che permetteva di creare diversi formati di testo per le varie sezioni dell'interfaccia come ad esempio:</p>
<ul>
    <li>Il font per i dialoghi mostrati nella parte superiore delo schermo;</li>
    <li>Il font usato per mostrare il testo della schermata d'interfaccia per i salvataggi e i caricamenti;</li>
    <li>Un altro font ancora per la parte bassa dell'interfaccia, quella che mostra i <em>verbs</em>;</li>
</ul>

<p><b>FLEM</b></p>
<p>Si trattava di un tool grafico, utilizzato per gestire le <em>rooms</em>.</p>
<p>Con questo tools, a partire da una immagine che mostrava una grafica di background, era possibile delineare le sagome degli oggetti interattivi all'interno della <em>room</em>, indicare i loro differenti stati (ad esempio Aperta o Chiusa nel caso l'oggetto fosse stato una porta), e anche costruire le <em>walk-boxes</em>.</p>
<p>FLEM permetteva inoltre di avere un veloce preview dei cosiddetti <em>clipping-planes</em>, altrimenti detti <em>z-planes</em> (che analizzeremo in dettaglio in un futuro articolo).</p>

<p><b>MMUCUS</b></p>
<p>Funzionava in congiunzione con FLEM e, a partire dall'immagine della room e dagli object data, i clipping-planes e le walk-boxes, arrivava ad ottenere in uscita un file room compresso contenente tutte queste informazioni.<br>Ho letto inoltre che MMUCUS si occupava anche di ottenere in uscita i files .LFL quando il gioco finale veniva compilato (tutti i byte venivano XOR-ati con 0x69 per impedire una eventuale tentativo di crack!).<br>Ron Gilbert aggiunge questi particolari alla descrizione di MMUCUS in un post <b>[d]</b> sul diario di lavorazione i <em>Timbleweed Park</em>, un nuovo progetto su cui sta lavorando assieme al suo vecchio collega Gary Winnick.</p>

<p><b>Byle</b> e <b>CYST</b></p>


<p>Altri tools, non nominati da Ron in quella occasione ma che so essere utilizzati sono:</p>
<ul>
    <li><b>iMuse</b>: ;</li>
    <li><b>INSANE</b>: ;</li>
</ul>

<p>vedi qui e qui</p>
<p>http://grumpygamer.com/</p>
<p>http://blog.thimbleweedpark.com/archives</p>
<div class="author">Nicola</div>

<h3>Riferimenti</h3>
<p><b>Links</b></p>
<ul>
    <li><b>[a]</b> <b>Ron Gilbert</b>'s <a class="ext" href="https://www.youtube.com/watch?v=RjA6GJfCDpY&t=6m24s" target="_blank">talk</a> in occasione del PAX 2009;</li>
    <li><b>[b]</b> <a class="ext" href="http://www.gamasutra.com/view/feature/196009/the_scumm_diary_stories_behind_.php?print=1" target="_blank">Articolo</a> su Gamasutra: "<b>The SCUMM Diary: Stories behind one of the greatest game engines ever made</b>" by <b>Mike Bevan</b>;</li>
    <li><b>[c]</b> <a class="ext" href="http://wiki.scummvm.org/index.php/SCUMM#Subsystems_of_SCUMM" target="_blank">Qui</a> ne parla il Wiki del progetto ScummVM;</li>
    <li><b>[d]</b> Timbleweed Park Dev. Diary: <b>The Big Decision</b> <a class="ext" href="http://blog.thimbleweedpark.com/tool_names" target="_blank">post</a>;</li>
</ul>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>




<article>
<header>
<a id="tools-02"></a>
<h2>Tools per analizzare e per giocare</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>
<p>ScummVM Tools</p>
<p>Ci si scarica il sorgente e poi si procede a configurarlo e poi a compilarlo.</p>
<p>Attenzione però alle dipendenze:</p>
<ul>
<li>libreria <a class="ext" href="https://www.libsdl.org/" target="_blank">SDL</a> 1.2 ;</li>
<li>libreria <a class="ext" href="http://www.vorbis.com/" target="_blank">OGG Vorbis</a>;</li>
<li>libreria <a class="ext" href="https://xiph.org/flac/" target="_blank">FLAC</a>;</li>
<li>libreria <a class="ext" href="http://www.underbit.com/products/mad/" target="_blank">MAD</a>, MPEG Audio Decoder</li>
<li>libreria <a class="ext" href="http://libpng.org/" target="_blank">PNG</a> 1.2.8 ;</li>
<li>libreria <a class="ext" href="http://freetype.org/" target="_blank">Freetype</a>: uan libreria libera per il rendering di fonts;</li>
<li>libreria <a class="ext" href="http://www.boost.org/" target="_blank">Boost</a> 1.32 ;</li>    
</ul>
<p>Altre cose interessanti da controllare</p>
<ul>
<li><a class="ext" href="http://scummvm.org/subprojects/" target="_blank">ScummEx</a>, sub-project del principale ScummVM;</li>
<li>Una serie di altri <a class="ext" href="http://www.jestarjokin.net/apps/" target="_blank">tools</a> by <b>jestar jokin</b> come ad esempio:
    <ul>
        <li><a class="ext" href="http://www.jestarjokin.net/apps/scummbler" target="_blank">Scummbler</a>;</li>
        <li><a class="ext" href="http://www.jestarjokin.net/apps/scummpacker" target="_blank">ScummPacker</a>;</li>
        <li><a class="ext" href="http://www.jestarjokin.net/apps/scummspeaks" target="_blank">ScummSpeaks</a>;</li>
        <li><a class="ext" href="http://www.jestarjokin.net/apps/scummimg" target="_blank">SCUMM Image Encoder</a>;</li>
    </ul></li>
<li><a class="ext" href="http://scummeditor.scummbr.com/" target="_blank">ScummEditor</a> di <b>Matheus Moreira</b></li>
<li><a class="ext" href="https://erolfi.wordpress.com/scumm-explorer/" target="_blank">Scumm Explorer</a> e diversi altri tools by <b>Enricol Rolfi</b>, non solo per Scumm ma anche relativi a SCI</li>
<li><b>Lucas Ripper</b> by Tobias Fleicher, aka <a class="ext" href="http://www.tobybear.de/files.html" target="_blank">Tobybear</a></li>
<li><a class="ext" href="http://jsg.id.au/scumm/scummrev/download.html" target="_blank">SCUMM Revisited</a>, anche se non sembrano funzionare i link per il download;</li>
<li>Il bellissimo lavoro di <a class="ext" href="http://quickandeasysoftware.net/software" target="_blank">Bennyboy</a>;</li>
</ul>

<p>altre cose interessanti si possono trovare su <b>scummC</b> se solo funzionasse.</p>

<div class="author">Nicola</div>
<h3>Riferimenti</h3>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>



<article>
<header>
<a id="descumming-scripts"></a>
<h2>De-Scumming Scripts</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>

<p>Come fare per ottenere una decompilazione degli script di un gioco Lucas sfruttando gli ScummVM Tools?</p>

<p>Abbiamo già detto che gli script del gioco sono codificati e compattati assieme a molti altri files all'interno di files contenitore più ampi. Estrapolarli può essere un compito assai arduo ma, per fortuna, gli sviluppatori di ScummVM ci forniscono un utile strumento che farà al caso nostro! Questo strumento è integrato direttamente nell'applicativo <b>scummvm</b> ed è facilmente accessibile direttamente da linae di comando!</p>

<p>Una volta estratti, questi file saranno illeggibili perchè in formato binario. Occorre allora un secondo strumento che sia in grado di  ottenerene altri corrispondenti, in formato <em>human-readable</em>.</p>
<p>Questo secondo strumento è <b>descumm</b> e fa parte degli <b>ScummVM Tools</b>!</p>

<p>Vediamo il procedimento passo passo:</p>

<div class="nota">
<p>Le annotazioni seguenti sono state testate su Mac OS X 10.6.8. I giochi utilizzati come cavie per gli esperimenti sono videogiochi originali, versione per PC.</p>
</div>

<h3>ScummVM da linea di comando </h3>
<p>Per usare <b>ScummVM</b> da linea di comando e, al tempo stesso sfruttare la sua capacità di estrapolazione degli script, sarà indispensabile specificare alcuni parametri iniziali.</p><p>Ecco il formato dell'istruzione da impartire a console:</p>
<pre class="code">./scummvm OPTIONS TARGET</pre>
<p>Per <em>TARGET</em> si intende l'identificativo del videogioco che ScummVM deve interpretare, mentre per <em>OPTIONS</em> si intendono una o più opzioni aggiuntive.</p>

<p>Supponiamo di voler esaminare alcuni scripts da <b>Monkey Island 2</b> e in particolare quelli tratti dalla room 35 la cascata di Phatt Island al salvataggio 29!</p>
<p>Per specificare che vogliamo caricare questo salvataggio, l'opzione da usare è <span class="code">-x</span> seguito da 29 nel nostro caso;</p>

<div class="img">
<img alt="Phatt Island Falls" src="http://www.limulo.net/images/scumm/cascata-phatt.png"/>
</div>


<p>L'altra opzione è, chiaramente, quella che attiva l'estrazione degli script. Si usa <span class="code">-u</span>. <br>Importante ricordare che questa estrazione avviene soltanto se nella directory corrente esiste una sotto directory chiamata <em>dumps</em>, in caso contrario la creiamo!</p>

<div class="dashed-border" style="padding: 1em;">
<p>Se non si conosce con precisione il nome del <em>TARGET</em> oppure si voglia visualizzare una lista di tutti i salvataggi relativi ad un TARGET specifico, basta avviare il programma con le 2 stringhe seguenti rispettivamente da linea di comando:</p>
<pre class="code">./scummvm -t<br>./scummvm - -list-saves=TARGET</pre>
</div>

<div class="nota">
<p><b>CORREGGI l'errore nel codice soprastante anteponendo a copy-protection i due trattini separati</b></p>
</div>

<p>Nel mio caso, il comando completo diventa quindi:</p>
<pre class="code">./scummvm -x 29 -u monkey2-it</pre>

<p>ScummVM si avvia, il gioco parte correttamente caricando il salvataggio specificato. Nel frattempo la cartella <em>dumps</em> comincia a riempirsi di file con estensione <b>.dmp</b>. A questo punto chiudiamo pure ScummVM e concentriamoci sui file contenuti nella cartella.</p>

<h3>descumm tool</h3>
<p>Questi files <b>.dmp</b> sono i famosi files scritti in binario di cui abbiamo parlato poco più sopra e che, per poter essere letti, devono essere "de-codificati".</p>

<p>Per capire meglio cosa stiamo per fare può essere d'aiuto capire come questi file binari siano stati ottenuti.</p>
<p>Abbiamo più volte ripetuto che il gioco veniva scritto dai programmatori LucasArts facendo uso del linguaggio di scripting SCUMM. Tutti questi script venivano compilati con un apposito compilatore per ottenerne il codice binario (espresso in 0 e 1) corrispondente; questi codici erano successivamente integrati con moltissimi altri dati a formare i files di risorse leggibili dall'interprete ed essere finalmente <em>giocati</em> dall'utente finale.</p>

<div class="img">
<img alt="Scumm Scripts Compiling" src="http://www.limulo.net/images/scumm/scumm-compiling.png"/>
</div>    

<p>Con il passare del tempo e le esigenze tecniche ed artistiche delle nuove avventure grafiche, anche il linguaggio SCUMM evolveva, modificandosi ed ampliandosi di nuove istruzioni e funzionalità. Di pari passo evolveva quindi anche il compilatore il quale ora doveva tradurre in binario set di istruzioni via via differenti rispetto a quelli delle versioni di linguaggio precedenti.</p>

<p>Quello che qui ci accingiamo a fare è il processo inverso: la <em>de-compilazione</em>, ricavare cioè, partendo dal file binario, il listato del programma originale scritto in linguaggio SCUMM così come era stato steso dagli stessi programmatori Lucas nel 1991 (Monkey Island 2 è stato rilasciato a Dicembre di quell'anno).</p>

<p>E' qui che entra in gioco <b>descumm</b> degli ScummVM-Tools.</p>

<div class="img">
<img alt="Scumm Scripts De-compiling" src="http://www.limulo.net/images/scumm/scumm-decompiling.png"/>
</div>

<p>Anche per questo tool faremo uso della linea di comando passando lui alcune opzioni.</p>
<p>L'opzione più importante da passare al tool è la <b>versione</b> del linguaggio con cui il gioco è stato scritto, infatti è solo conoscendo il set di istruzioni del linguaggio SCUMM usato nello scrivere il listato originale che il de-compilatore <b>descumm</b> sarà in grado di tradurre il binario in modo corretto. Ecco perchè i primi tempi ci siamo soffermati su <a href="#versioni">questi</a> concetti.</p>

<p>L'output del comando descumm sarà lo script e verrà mostrato sullo standard output. E' tuttavia possibile reindirizzarlo per ottenere un più pratico file di testo.</p>
<p>La altre opzioni che è possibile specificare riguardano soprattutto la formattazione del codice in output, che noi, per il momento non useremo.</p>
<p>Ecco il comando completo:</p>
<pre class="code">./descumm -5 -x -c INPUTFILE.dmp>OUTPUTFILE.txt</pre>

<p>Come vedete ho aggiunto al comando gli attributi <span class="code">x</span> e <span class="code">c</span> che, rispettivamente, nascondo l'indicazione dell'offset e dell'opcode dall'output per una lettura più facile del codice.</p>

<p>Per avere maggiori informazioni sull'uso di questo tool e per conoscere gli altri attributi che si possono usare, digitate la seguente riga a console:
</p>
<pre class="code">./descumm - -help</pre>
<div class="nota">
correggi l'errore qui sopra togliendo il doppio trattino.
</div>

<div class="author">Nicola</div>
<h3>Riferimenti</h3>
<p><b>Links</b></p>
<ul>
    <li><b>[a]</b> da Wikipedia: <a class="ext" href="https://en.wikipedia.org/wiki/Monkey_Island_2%3A_LeChuck%27s_Revenge" target="_blank">Monkey Island 2</a>;</li>
    <li><b>[b]</b> la pagina degli <a class="ext" href="http://wiki.scummvm.org/index.php/SCUMM/V5_opcodes" target="_blank">Opcode</a> e delle variabili per la versione 5 del linguaggio SCUMM, direttamente dalla <em>Technical Reference</em> del Wiki per ScummVM;</li>
</ul>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>






<article>
<header>
<a id="deluaing-scripts"></a>
<h2>De-Lua-ing script:</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>

<div class="nota">
<p>Le annotazioni seguenti sono state testate su Mac OS X 10.6.8. I giochi utilizzati come cavie per gli esperimenti sono videogiochi originali, versione per PC.</p>
</div>

<p>E' vero, Crim Fandango non ha nulla a che fare con Scumm, ma questo argomento è comunque collegato</p>

<p>Articolo dedicato al sistema di script implementato in <b>GrimE</b> (Grim Fandango Engine), motore di gioco che rappresenta la moderna evoluzione del sistema Scumm per il funzionamento dei videogiochi di avventura di nuova generazione come <b>Grim Fandango</b> e <b>Escape from Monkey Island</b>.</p>
<p>Scumm non era più sufficiente: ora la necessità era quella di implementare un motore di calcolo floating point ma soprattutto la fantastica grafica 3D!</p>
<p>Il programmatore <b>Bret Mogilefsky</b> si è occupato del lavoro di traduzione di Scumm in GrimE, effettuando un simbolico passaggio di testimone dal sig. <b>Ron Gilbert</b>.</p>


<p>occorre parlare di </p>
<ul>
  <li>floating point</li>
  <li>3D</li>
  <li>Linguaggio di scripting non da reinventare da capo e quindi <b>Lua</b></li>
</ul>

<p>Sappiamo che, a differenza di Scumm, il linguaggio di scripting utilizzato per la realizzazione di Grim Fandango non è stato riscritto da zero. All'epoca, parliamo del 1998, i progettisti hanno pensato bene di cercare un linguaggio di scripting già esistente e che si potesse adattare bene alle loro esigenza: trovarono Lua, al tempo alla version <b>XXX</b>.</p>

<div class="nota">
<p>Documenta un po' meglio il discorso del linguaggio di pregramamzione LUA</p>
</div>

<p>Ebbene, scelto Lua come linguaggio per la stesura degli script, questi stessi script sono compattati assieme a tutte le altre risorse del gioco all'interno di file contenitore denominati <b>.LAB</b> (acronimo per LucasArts Bundle).</p>

<p>Informazioni utili sul bundle e il tipo di risorse contenute so trovano al link <b>[h]</b> cliccabile dalla sezione riferimenti più in basso.</p>

<div class="img">
<img alt="GrimE Scripts Compiling" src="http://127.0.0.1/limulo.net/images/scumm/grime-compiling.png"/>
</div>  

<p>Il progetto <b>ResidualVM</b> si è occupato di riscrivere l'interprete GrimE per rendere possibile l'esecuzione di questi giochi sui moderni sistemi</p>
<p>Come per il progetto ScummVM, i programmatori costruirono una nutrita suite di tools per esaminare i files eseguibili originali, così anche il progetto ResidualVM possiede i propri tools (vedi <b>[f]</b>)

<p>Nonostante questi tools non siano così ben documentati come lo sono quelli della controparte ScummVM, è possibile utilizzarli facendo lavoro di intuito: dopo una configurazione e una compilazione per il proprio sistema operativo, i tools che possono essere utilizzati sono i seguenti:</p>
<ul>
<li><b>unlab</b>: tool per l'estrazione dal file risorse <b>.LAB</b> delle singole componenti (files audio, scripts, modelli 3D, etc...);</li>
<li><b>delua</b>: tool per la decompilazione del codice binario degli script lua</li>
</ul>

<p>Ebbene sì, sembra che gli script .lua siano stati impacchettati nei file contenitore una volta che siano già stati compilati. Per riuscire a leggerli sono necessarie quindi due operazioni: lo spacchettamento e la decompilazione lua entrambe visibili nella figura sottostante e denominate rispettivamente con il nome del tool preposto all'operazione, <b>unlab</b> e <b>delua</b>.</p>

<div class="img">
<img alt="GrimE Scripts De-Compiling" src="http://127.0.0.1/limulo.net/images/scumm/grime-decompiling.png"/>
</div>

<p>I comandi da terminale per eseguire le operazioni di cui sopra sono i seguenti:</p>    
<pre class="code">./unlab NOMEFILE.lab</pre>
<pre class="code">./delua INPUTFILE.lua > OUTPUTFILE.lua</pre>
<p>non ci sarebbe nessuan differenza nel voler utilizzare un file <span class="code">.txt</span> come output, il comando allora diverrebbe il seguente:</p>
<pre class="code">./delua INPUTFILE.lua > OUTPUTFILE.txt</pre>

<h3>Decompressione dei files audio</h3>
<p>Un archivio <b>.LAB</b> può contenere anche molte altre tipologie di files oltre agli scripts, una di queste è la tipologia file audio.</p>
<p>In un archivio .LAB possono essere presenti diversi files audio con estensione <b>.wav</b> che ho scoperto però essere illeggibili da un qualsiasi riproduttore musicale. Questo perchè i suddetti files sono in formato "compresso" ed occorre provvedere alla relativa decompressione prima di poter udire il sonoro vero e proprio.</p>

<p>Il tool preposto per decomprimere questi file audio è <b>vima</b>; il comando da terminale che utilizzo è questo:</p>
<pre class="code">./vima FILECOMPRESSO.wav > FILENONCOMPRESSO.wav</pre>

<p>Sembra che i files audio di Grim Fandango subissero una compressione denominata VIMA, come descritto qui <b>[g]</b>.</p>

<h3>Altri spunti interessanti per continuare a scrivere l'articolo</h3>
<p>Ecco un link interessante al <a class="ext" href="http://www.grimfandango.net/downloads/puzzle-document" target="_blank">Grim Fandango Puzzle Document</a>.</p>
<p>Grim Fandango <a class="ext" href="http://www.grim-fandango.com/hacking.php" target="_blank">Hacking</a>!!</p>
<p>Necessari approfondimenti sugli altri tools e, senza dubbio un approfondimento sul formato dei file audio che vengono estratti dai files di risorse. Stessa cosa dicasi per le mesh e per i costumes.</p>


<div class="author">Nicola</div>

<h3>Riferimenti</h3>
<p><b>Links</b></p>
<ul>
    <li><b>[a]</b> <a class="ext" href="http://www.lua.org" target="_blank">LUA</a>;</li>
    <li><b>[b]</b> articolo <a class="ext" href="http://www.grimfandango.net/features/articles/lua-in-grim-fandango" target="_blank">Lua in Grim Fandango</a> by <b>Bret Mogilefsky</b>. interessanti anche le sue due interviste <a class="ext" href="http://www.grimfandango.net/features/interviews/interview-with-bret-mogilefsky" target="_blank">qui</a> e <a class="ext" href="http://www.grimfandango.net/features/interviews/interview-with-bret-mogilefsky-2" target="_blank">qui</a>;</li>
    <li><b>[c]</b> le <a class="ext" href="http://www.lua.org/wshop05/Mogul.pdf" target="_blank">slides</a> del talk tenuto dallo stesso Mogilefsky in occasione del <a class="ext" href="http://www.lua.org/wshop05.html" target="_blank">workshop</a>;</li>
    <li><b>[d]</b> sito interessante 1: <a class="ext" href="http://grim-fandango.com/" target="_blank">link</a>;</li>
    <li><b>[e]</b> sito interessante 2: <a class="ext" href="http://www.grimfandango.net/" target="_blank">link</a>;</li>
    <li><b>[f]</b> link alla pagina del progetto <a class="ext" href="http://residualvm.org/" target="_blank">ResidualVM</a> e a quella GitHub dei relativi <a class="ext" href="https://github.com/residualvm/residualvm-tools" target="_blank">tools</a>.</li>    
    <li><b>[g]</b> <a class="ext" href="http://wiki.multimedia.cx/index.php?title=VIMA" target="_blank">VIMA</a> codec;</li>    
  <li><b>[h]</b> <a class="ext" href="http://forums.residualvm.org/viewtopic.php?t=257" target="_blank">.LAB</a> topic;</li>
</ul>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>





<article>
<header>
<a id="scaling"></a>
<h2>Scaler and scaling</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>

<p>A quanto riferisce <b>Ron Gilbert</b> stesso in questo suo <a class="ext" href="http://blog.thimbleweedpark.com/parallaxing" target="_blank">post</a>, lo scaling per l'<b>attore</b> non venne introdotto nel sistema SCUMM almeno fino al gioco <b>Monkey Island</b></p>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>


<article>
<header>
<a id="roland"></a>
<h2>Roland MT-32</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>
<p>Come suona?</p>
<p>Munt</p>

<p>pre GM-MIDI devices?</p>
<p>http://www.sierrahelp.com/Utilities/Emulators/Munt.html</p>
<p>https://github.com/munt/munt</p>
<p>http://munt.sourceforge.net/</p>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>



<article>
<header>
<a id="imuse"></a>
<h2>iMuse</h2>
<time datetime="2015-05-01T09:00:00+01:00">1 Maggio 2015</time>
</header>
<p>No, non si tratta di un nuovo prodotto Apple! <b>iMUSE</b> sta per <b>I</b>nteractive <b>MU</b>sic <b>S</b>treaming <b>E</b>ngine ed è un motore integrato all'interno dell'engine SCUMM (a partire dalla versione 5) per occuparsi della gestione delle risorse audio per la colonna sonora delle avventure grafiche LucasArts.</p>

<p>L'obiettivo è permeare l'intera avventura grafica con una colonna sonora persistente e sempre in linea con i momenti emozionali della storia che, non potendo essere previsti o prefissati, deve essere pronta ad adattarsi dinamicamente all'impronta interattiva del gioco.</p>


<p><b>iMuse</b> venne sviluppata da Micheal land a seguito della sua frustrazione legata al precedente sistema audio in uso presso la LucasFilm Games. All'epoca Land stava lavorando al progetto The Secret of Monkey Island e la sua frustrazione nasceva dal fatto che, giocandoci, non si riusciva ad avere l'impressione di una colonna sonora ben integrata nelle dinamiche del gioco. Spessi erano i momenti in cui, nei passaggi tra una room e l'altra o tra 2 situazioni emotive diametralmente opposte, la musica, anzichè seguire l'andamento della storioa in un cuntinuum coerente, fosse soltanto un brusco passaggio tra due tracce audio completamente discordi tra loro.</p>


<p>iMUSE was developed out of Michael Land's frustration for the audio system used by LucasArts while composing The Secret of Monkey Island. His goal was to create a system which would enable the composer to set the mood via music according to the events of the game. The project was much more daring than he had imagined. He then brought in an old friend, Peter McConnell, to collaborate on creating the system which they later patented together.[4] The first game to use the iMUSE system was Monkey Island 2: LeChuck's Revenge,[5] and it has been used in all LucasArts adventure games since.[6] It has also been used for some non-adventure LucasArts titles such as the DOS version of Star Wars: TIE Fighter.[7]</p>

<p>Il sistema iMuse contiene diverse componenti software. Abbiamo una prima parte che è il database, ovvero la raccolta di tutti dati MIDI delle musiche e talvolta anche degli effetti sonori che debbano essere riprodotti dirante il gioco. Queste sequenze musicali contengono al loro interno dei cosidetti <em>punti decisionali</em>, dei marker in buona sostanza che indicano dove possano avvenire eventuali cambiamenti su base delle condizioni di gioco in tempo reale.</p>

<p>Le azioni includono:</p>
<ul>
    <li>la possibilità attivare o <em>mute</em>-are (o eventualmente regolare il volume) di uno o più parti strumentali.</li>
    <li>la trasposizione di alcune parti musicali;</li>
    <li>change instrument selection;</li>
    <li>saltare ad altre sezioni;</li>
    <li>mettere in loop una o più sequenze;</li>
    <li>ritardare l'esecuzione di una sequenza;</li>
    <li>effettuare il <em>detuning</em> di uno strumento;</li>
    <li>fare il <em>pan</em>ning;</li>
    <li>alterare la velocità di un suono;</li>
    <li>e così via...</li>
</ul>

<p>Quando il driver sonoro raggiunge il <em>punto decisionale</em>, procede a valutare la condizione che è stata impostata, e determina l'azione appropriata.</p>

<p>brevetto iMuse</p>
<p>che cosa fa?</p>
<p>Si può apprezzare meglio ad esempio in Monkey Island 2, forse perchè il ritmo e il genere è più o meno lo stesso, coerente dall'inizio alal fine del gioco</p>
<p>esempio degli strumenti che entrano, uno dopo l'altro in sequenza mano a mano che ci si addentra nella palude di woodoo lady</p>
<p>oppure le sequenza di ingresso o di fine</p>

<p>Fate of atlantis: menzione speciale per musiche lunghe ed interessanti, non stancano!</p>

<b>Altre Idee</b>
<p>ci furono 4 giochi adventure significativi basati sul MIDI 16-bit iMuse:
- The Secret of Monkey Island 2:LeChuck's Revenge (1991)
- Sam & Max Hit The Road (1993)
- Indiana Jones and the Fate of Atlantis (1992)
- The Day of The Tentacle (1993)
Tutti i giochisono stati co-composti da Clint Bajakian, Peter McConnell e Micheal Land, i creatori del sistema iMuse.

Una colonna sonora che comincia all'inizio del gioco e termina alla fine.

La musica non poteva rispondere intelligentemente agli eventi del gioco, e il risultato era, tipicamente, transizioni abbastanza jarring(?) tra sequenze musicali nel gioco (HARD CUTS).

</p>



<h3>Riferimenti</h3>
<p><b>Books and Papers</b></p>
<ul>
    <li><b>[1]</b> Collins, K. (2008). <a class="ext" href="http://mitpress.mit.edu/books/game-sound" target="_blank">Game Sound</a>. The MIT Press.;</li>
</ul>

<p><b>links</b></p>
<ul>
    <li><b>[a]</b> <a class="ext" href="http://patentimages.storage.googleapis.com/pdfs/US5315057.pdf" target="_blank">link</a> al brevetto iMuse, Patent US5315057, May 24, 1994;</li>
    <li><b>[b]</b> da Wikipedia: <a class="ext" href="https://en.wikipedia.org/wiki/IMUSE" target="_blank">iMuse</a>;</li>
</ul>

<footer>
<div class="firma">http://www.limulo.net</div>
<a class="top" href="#indice">torna all'indice</a>
</footer>
</article>
